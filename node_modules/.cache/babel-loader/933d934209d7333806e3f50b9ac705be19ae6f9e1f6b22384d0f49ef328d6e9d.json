{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import BookCard from'./BookCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookSearch=_ref=>{let{toggleBookshelf,bookshelf}=_ref;const[query,setQuery]=useState('');const[books,setBooks]=useState([]);const cache=useRef({});const fetchBooks=async searchQuery=>{if(cache.current[searchQuery]){setBooks(cache.current[searchQuery]);}else if(searchQuery.length>2||searchQuery==='initial'){try{const response=await fetch(\"https://openlibrary.org/search.json?q=\".concat(searchQuery==='initial'?'bestsellers':searchQuery,\"&limit=10&page=1\"));const data=await response.json();cache.current[searchQuery]=data.docs;setBooks(data.docs);}catch(error){console.error('Error fetching books:',error);}}else{setBooks([]);}};useEffect(()=>{fetchBooks('initial');// Fetch initial set of books\n},[]);useEffect(()=>{const handler=setTimeout(()=>{fetchBooks(query);},300);// Throttle the API calls by 300ms\nreturn()=>{clearTimeout(handler);};},[query]);const isBookInBookshelf=book=>{return bookshelf.some(b=>b.key===book.key);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inputGroup\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:query,onChange:e=>setQuery(e.target.value),required:true,autoComplete:\"off\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"search\",children:\"Search for books...\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"book-list\",children:books.map(book=>/*#__PURE__*/_jsx(BookCard,{book:book,toggleBookshelf:toggleBookshelf,isBookInBookshelf:isBookInBookshelf},book.key))})]});};export default BookSearch;","map":{"version":3,"names":["React","useState","useEffect","useRef","BookCard","jsx","_jsx","jsxs","_jsxs","BookSearch","_ref","toggleBookshelf","bookshelf","query","setQuery","books","setBooks","cache","fetchBooks","searchQuery","current","length","response","fetch","concat","data","json","docs","error","console","handler","setTimeout","clearTimeout","isBookInBookshelf","book","some","b","key","children","className","type","value","onChange","e","target","required","autoComplete","htmlFor","map"],"sources":["C:/Users/KRISHNA KUMAR/Desktop/personal-bookshelf/src/components/BookSearch.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport BookCard from './BookCard';\r\n\r\nconst BookSearch = ({ toggleBookshelf, bookshelf }) => {\r\n  const [query, setQuery] = useState('');\r\n  const [books, setBooks] = useState([]);\r\n  const cache = useRef({});\r\n\r\n  const fetchBooks = async (searchQuery) => {\r\n    if (cache.current[searchQuery]) {\r\n      setBooks(cache.current[searchQuery]);\r\n    } else if (searchQuery.length > 2 || searchQuery === 'initial') {\r\n      try {\r\n        const response = await fetch(`https://openlibrary.org/search.json?q=${searchQuery === 'initial' ? 'bestsellers' : searchQuery}&limit=10&page=1`);\r\n        const data = await response.json();\r\n        cache.current[searchQuery] = data.docs;\r\n        setBooks(data.docs);\r\n      } catch (error) {\r\n        console.error('Error fetching books:', error);\r\n      }\r\n    } else {\r\n      setBooks([]);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchBooks('initial'); // Fetch initial set of books\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const handler = setTimeout(() => {\r\n      fetchBooks(query);\r\n    }, 300); // Throttle the API calls by 300ms\r\n\r\n    return () => {\r\n      clearTimeout(handler);\r\n    };\r\n  }, [query]);\r\n\r\n  const isBookInBookshelf = (book) => {\r\n    return bookshelf.some((b) => b.key === book.key);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"inputGroup\">\r\n        <input \r\n          type=\"text\"\r\n          value={query}\r\n          onChange={(e) => setQuery(e.target.value)}\r\n          required\r\n          autoComplete=\"off\"\r\n        />\r\n        <label htmlFor=\"search\">Search for books...</label>\r\n      </div>\r\n      <div className=\"book-list\">\r\n        {books.map((book) => (\r\n          <BookCard \r\n            key={book.key} \r\n            book={book} \r\n            toggleBookshelf={toggleBookshelf} \r\n            isBookInBookshelf={isBookInBookshelf} \r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookSearch;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,MAAO,CAAAC,QAAQ,KAAM,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAElC,KAAM,CAAAC,UAAU,CAAGC,IAAA,EAAoC,IAAnC,CAAEC,eAAe,CAAEC,SAAU,CAAC,CAAAF,IAAA,CAChD,KAAM,CAACG,KAAK,CAAEC,QAAQ,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACc,KAAK,CAAEC,QAAQ,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAAgB,KAAK,CAAGd,MAAM,CAAC,CAAC,CAAC,CAAC,CAExB,KAAM,CAAAe,UAAU,CAAG,KAAO,CAAAC,WAAW,EAAK,CACxC,GAAIF,KAAK,CAACG,OAAO,CAACD,WAAW,CAAC,CAAE,CAC9BH,QAAQ,CAACC,KAAK,CAACG,OAAO,CAACD,WAAW,CAAC,CAAC,CACtC,CAAC,IAAM,IAAIA,WAAW,CAACE,MAAM,CAAG,CAAC,EAAIF,WAAW,GAAK,SAAS,CAAE,CAC9D,GAAI,CACF,KAAM,CAAAG,QAAQ,CAAG,KAAM,CAAAC,KAAK,0CAAAC,MAAA,CAA0CL,WAAW,GAAK,SAAS,CAAG,aAAa,CAAGA,WAAW,oBAAkB,CAAC,CAChJ,KAAM,CAAAM,IAAI,CAAG,KAAM,CAAAH,QAAQ,CAACI,IAAI,CAAC,CAAC,CAClCT,KAAK,CAACG,OAAO,CAACD,WAAW,CAAC,CAAGM,IAAI,CAACE,IAAI,CACtCX,QAAQ,CAACS,IAAI,CAACE,IAAI,CAAC,CACrB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC/C,CACF,CAAC,IAAM,CACLZ,QAAQ,CAAC,EAAE,CAAC,CACd,CACF,CAAC,CAEDd,SAAS,CAAC,IAAM,CACdgB,UAAU,CAAC,SAAS,CAAC,CAAE;AACzB,CAAC,CAAE,EAAE,CAAC,CAENhB,SAAS,CAAC,IAAM,CACd,KAAM,CAAA4B,OAAO,CAAGC,UAAU,CAAC,IAAM,CAC/Bb,UAAU,CAACL,KAAK,CAAC,CACnB,CAAC,CAAE,GAAG,CAAC,CAAE;AAET,MAAO,IAAM,CACXmB,YAAY,CAACF,OAAO,CAAC,CACvB,CAAC,CACH,CAAC,CAAE,CAACjB,KAAK,CAAC,CAAC,CAEX,KAAM,CAAAoB,iBAAiB,CAAIC,IAAI,EAAK,CAClC,MAAO,CAAAtB,SAAS,CAACuB,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACC,GAAG,GAAKH,IAAI,CAACG,GAAG,CAAC,CAClD,CAAC,CAED,mBACE7B,KAAA,QAAA8B,QAAA,eACE9B,KAAA,QAAK+B,SAAS,CAAC,YAAY,CAAAD,QAAA,eACzBhC,IAAA,UACEkC,IAAI,CAAC,MAAM,CACXC,KAAK,CAAE5B,KAAM,CACb6B,QAAQ,CAAGC,CAAC,EAAK7B,QAAQ,CAAC6B,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAC1CI,QAAQ,MACRC,YAAY,CAAC,KAAK,CACnB,CAAC,cACFxC,IAAA,UAAOyC,OAAO,CAAC,QAAQ,CAAAT,QAAA,CAAC,qBAAmB,CAAO,CAAC,EAChD,CAAC,cACNhC,IAAA,QAAKiC,SAAS,CAAC,WAAW,CAAAD,QAAA,CACvBvB,KAAK,CAACiC,GAAG,CAAEd,IAAI,eACd5B,IAAA,CAACF,QAAQ,EAEP8B,IAAI,CAAEA,IAAK,CACXvB,eAAe,CAAEA,eAAgB,CACjCsB,iBAAiB,CAAEA,iBAAkB,EAHhCC,IAAI,CAACG,GAIX,CACF,CAAC,CACC,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAA5B,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}